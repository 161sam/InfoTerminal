# Deprecation window for legacy routes (ISO8601, e.g. 2025-10-31)
IT_DEPRECATION_CUTOFF_DATE=2025-10-31

# Web / Frontend
NEXT_PUBLIC_SEARCH_URL=http://localhost:8001
NEXT_PUBLIC_GRAPH_URL=http://localhost:8002
NEXT_PUBLIC_DOCENTITIES_URL=http://localhost:8006
NEXT_PUBLIC_MEDIA_FORENSICS_URL=http://localhost:8618
NEXT_PUBLIC_SUPERSET_URL=http://localhost:8083
NEXT_PUBLIC_ALEPH_BASE_URL=http://localhost:8082/api/2

# Backends

# Ports
GRAPH_VIEWS_PORT=8403

# App
IT_ENV=dev
IT_FORCE_READY=0
GV_ALLOW_WRITES=1   # f체r lokale Entwicklung praktisch

# Optional Basic Auth for WRITE endpoints (if set, required for ?write=1)
GV_BASIC_USER=dev
GV_BASIC_PASS=devpass

# Neo4j (Compose-Hostname im gemeinsamen Netz)
NEO4J_URI=bolt://it-neo4j:7687
NEO4J_USER=neo4j
NEO4J_PASSWORD=test12345
NEO4J_DATABASE=neo4j

# Optional tuning
NEO4J_MAX_CONN_LIFETIME=3600

# Frontend
NEXT_PUBLIC_VIEWS_API=http://localhost:8403
# Hinweis: In PROD GV_ALLOW_WRITES nicht aktivieren und Secrets nicht einchecken

# Search Reranking
RERANK_ENABLED=0
RERANK_TOPK=50
RERANK_MODEL=sentence-transformers/all-MiniLM-L6-v2
RERANK_TIMEOUT_MS=800

# Doc-Entities Resolver
RESOLVE_MATCH_THR=0.85
RESOLVE_AMBIG_MIN=0.60
RESOLVE_AUTOCREATE=0
GRAPH_WRITE_RELATIONS=1

# Media Forensics
IT_PORT_MEDIA_FORENSICS=8618
MEDIA_MAX_FILE_SIZE=52428800
REVERSE_SEARCH_ENABLED=0
# BING_SEARCH_API_KEY=your-bing-api-key

# Plugin Runner
IT_PORT_PLUGIN_RUNNER=8621
PLUGIN_DOCKER_ENABLED=1
PLUGIN_MAX_EXECUTION_TIME=300
PLUGIN_MAX_CONCURRENT=5

# Aleph
ALEPH_API_KEY=changeme
ALLOW_DEMO_LOADER=1

# Optional App Ports (compose profiles)
IT_PORT_ALEPH=8641
IT_PORT_SUPERSET=8644
IT_PORT_AIRFLOW=8642
IT_PORT_NIFI=8619

# Superset admin (dev defaults)
SUPERSET_SECRET_KEY=this_is_not_secure
SUPERSET_LOAD_EXAMPLES=no
SUPERSET_ADMIN_USERNAME=admin
SUPERSET_ADMIN_PASSWORD=adminadmin
SUPERSET_ADMIN_FIRSTNAME=Admin
SUPERSET_ADMIN_LASTNAME=User
SUPERSET_ADMIN_EMAIL=admin@example.com

# Airflow admin (dev defaults)
AIRFLOW_ADMIN_USERNAME=admin
AIRFLOW_ADMIN_PASSWORD=adminadmin
AIRFLOW_ADMIN_FIRSTNAME=Admin
AIRFLOW_ADMIN_LASTNAME=User
AIRFLOW_ADMIN_EMAIL=admin@example.com

# OIDC / oauth2-proxy (SSO profile)
OAUTH2_PROXY_COOKIE_SECRET=c29tZS1kZXYtY29va2llLXNlY3JldC10ZXN0LXN0cmluZw==
OAUTH2_PROXY_SUPERSET_CLIENT_ID=superset
OAUTH2_PROXY_SUPERSET_CLIENT_SECRET=superset-secret
OAUTH2_PROXY_AIRFLOW_CLIENT_ID=airflow
OAUTH2_PROXY_AIRFLOW_CLIENT_SECRET=airflow-secret

# Observability
GF_SECURITY_ADMIN_USER=admin
GF_SECURITY_ADMIN_PASSWORD=admin
PROMETHEUS_PORT=3412
GRAFANA_PORT=3413
ALERTMANAGER_PORT=3414
LOKI_PORT=3415
TEMPO_PORT=3416

# Tracing / OTEL (set IT_OTEL=1 to enable)
IT_OTEL=0
OTEL_EXPORTER_OTLP_ENDPOINT=http://tempo:4318
OTEL_SERVICE_NAME=
OTEL_TRACES_SAMPLER=parentbased_traceidratio
OTEL_TRACES_SAMPLER_ARG=0.1
OTEL_RESOURCE_ATTRIBUTES=deployment.environment=dev

# Optional write rate limit (format: N/second|minute|hour)
GV_RATE_LIMIT_WRITE=20/minute
# Optional audit JSON logs to STDOUT for write requests
GV_AUDIT_LOG=1

# ---- v0.2 MUST feature envs (add if missing) ----
# Auth / OIDC
IT_AUTH_REQUIRED=0
AUTH_REQUIRED=0
OIDC_ISSUER=http://localhost:8089/realms/mock
OIDC_CLIENT_ID=infoterminal-frontend
OIDC_REDIRECT_URI=http://localhost:3411/auth/callback
# Feed connectors
FEEDS_ENABLED=0
RSS_ENABLED=0
FEED_OTX_ENABLED=0
RSS_FEED_URL=https://example.com/rss.xml
RSS_FETCH_INTERVAL=300
RSS_DRY_RUN=1
OTX_API_URL=https://otx.alienvault.com/api/v1/pulses/subscribed
OTX_FETCH_INTERVAL=900
OTX_DRY_RUN=1
IT_OIDC_ISSUER=http://localhost:8643/realms/infoterminal
IT_OIDC_AUDIENCE=infoterminal
IT_OIDC_JWKS_URL=http://localhost:8643/realms/infoterminal/protocol/openid-connect/certs
IT_OIDC_SKEW=60
OPA_URL=http://localhost:8181/v1/data/access/allow

# Observability (opt-in)
IT_ENABLE_METRICS=0
IT_REQUEST_ID_HEADER=X-Request-Id

# Ports (authoritative via patch_ports.sh)
IT_PORT_FRONTEND=3411
IT_PORT_PROM=3412
IT_PORT_GRAFANA=3413
IT_PORT_ALERTMAN=3414
IT_PORT_LOKI=3415
IT_PORT_TEMPO=3416
IT_PORT_FLOWISE=3417
IT_PORT_GATEWAY=8610
IT_PORT_SEARCH_API=8611
IT_PORT_GRAPH_API=8612
IT_PORT_DOC_ENTITIES=8613
IT_PORT_EGRESS_GATEWAY=8615
IT_PORT_VERIFICATION=8617

# Egress Gateway Security
EGRESS_BASIC_USER=dev
EGRESS_BASIC_PASS=devpass
EGRESS_TOR_ENABLED=1
EGRESS_VPN_ENABLED=0
EGRESS_PROXY_ROTATION=1

# Feature flags
IT_NEO4J_GDS=0
IT_ENRICH_DOCS=0
# Dossier
IT_DOSSIER_PDF=0
# NLP
NLP_DEFAULT_LANG=en
NLP_BACKEND=spacy           # spacy|transformers
NLP_SPACY_MODEL_EN=en_core_web_sm
NLP_SPACY_MODEL_DE=de_core_news_sm
# Agent / Flowise / n8n
AGENT_BASE_URL=http://localhost:3417
AGENT_TIMEOUT_MS=120000
AGENT_PLAYBOOKS=static
N8N_BASE_URL=http://localhost:5678
N8N_API_KEY=
N8N_WEBHOOK_URL=

# Geospatial
NEXT_PUBLIC_MAP_TILES=https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png
GEO_UPLOAD_DIR=/data/geo
# --- Plugin System ---
IT_PLUGINS_DIR=plugins
IT_PLUGINS_STATE_DIR=/data/plugins
IT_PLUGINS_ENABLE=1
IT_PLUGIN_API_VERSION=v1
IT_PLUGINS_CACHE_TTL_SEC=30   # Discovery/Health Cache TTL

# (Optional) Audit Sink (sp채ter ClickHouse via Vector/OTEL)
IT_AUDIT_SINK=stdout          # stdout|clickhouse
CH_URL=http://localhost:8123
CH_DB=infoterminal_audit
CH_USER=default
CH_PASSWORD=

# Multi-Tenancy
IT_TENANCY_MODE=single        # single|multi
IT_TENANT_CLAIM=tenant        # OIDC claim f체r Tenant/Org
# --- Ops GUI / Infra Control ---
IT_OPS_ENABLE=1                    # 0=aus, 1=an (Default for v0.2.0)
IT_OPS_MODE=docker                 # docker | k8s (k8s sp채ter)
IT_DOCKER_SOCKET=/var/run/docker.sock
IT_OPS_ALLOW_SHELL=0               # niemals Shell erlauben
IT_OPS_LOCK_TIMEOUT_SEC=120
IT_OPS_LOG_TAIL_LINES=300
IT_OPS_COMPOSE_BIN=docker compose  # oder 'docker-compose' je nach System
IT_OPS_STACKS_FILE=infra/ops/stacks.yaml
IT_PORT_OPS_CONTROLLER=8614       # Ops controller service port
OPS_CONTROLLER_URL=http://localhost:8614  # Frontend API proxy target

# --- RAG / Legal Layer ---
IT_PORT_RAG_API=8622
IT_PORT_COLLAB=8625
IT_PORT_XAI=8626
IT_PORT_FORENSICS=8627
IT_PORT_FEDERATION=8628
RAG_OS_INDEX=laws
OS_URL=http://opensearch:9200
NEO4J_URI=bolt://neo4j:7687
NEO4J_USER=neo4j
NEO4J_PASSWORD=neo4j
RAG_OS_KNN=0
RAG_OS_KNN_ENGINE=nmslib
RAG_OS_KNN_SPACE=cosinesimil
RAG_OS_KNN_EF_SEARCH=64
RAG_OS_KNN_EF_CONSTRUCTION=128
RAG_OS_KNN_M=16
